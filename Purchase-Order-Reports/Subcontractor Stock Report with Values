# üìä Subcontractor Stock Report with Values

[‚¨ÖÔ∏è Back to Purchase Order Reports](../)

## üìã Overview

This ABAP report provides comprehensive visibility into subcontractor stock levels and values, tracking both raw materials (ROH) at vendor locations and finished goods (FG) produced through subcontracting. Built with AI assistance to eliminate dependency on technical teams, this report empowers SAP MM consultants to monitor and analyze subcontractor inventory efficiently.

## üéØ Business Purpose

**Problem Solved**: 
- Manual tracking of materials at subcontractor locations
- No visibility into stock values at vendor sites
- Difficulty reconciling subcontractor inventory
- Time-consuming analysis of subcontracting efficiency

**Solution Benefits**:
- ‚úÖ Real-time stock visibility at vendor locations
- ‚úÖ Automatic valuation using moving average prices
- ‚úÖ Transaction-level detail for auditing
- ‚úÖ Combined view of raw materials and finished goods

## üöÄ Key Features

### Stock Tracking
- **Dual Stock Types**: Tracks both ROH (raw materials) and FG (finished goods)
- **Period-Based Analysis**: Beginning and ending balances for any fiscal period
- **Multi-Vendor Support**: Analyze multiple subcontractors simultaneously
- **Value Calculation**: Automatic valuation using SAP moving average prices

### Transaction Details
- Complete movement history within selected period
- Movement types: Goods receipts, transfers, consumption, deliveries
- Direct links to material documents and purchase orders
- Reference document tracking for audit trails

### Display Capabilities
- Hierarchical display: Material summary with expandable transactions
- Subtotals by stock type (ROH/FG)
- Grand totals for quantities and values
- Export to Excel for further analysis

## üìä Report Output

### Main Sections:

1. **Material Summary Line**
   - Stock Type (ROH/FG)
   - Material number and description
   - Beginning/Ending quantities
   - Beginning/Ending values
   - Material group and type information

2. **Transaction Details** (Below each material)
   - Posting date
   - Movement type and quantity
   - Material document reference
   - Amount in local currency
   - Purchase order reference

### Sample Output Structure:
```
Stock Type | Material | Description | Beg Stock | End Stock | Beg Value | End Value
-----------|----------|-------------|-----------|-----------|-----------|----------
ROH        | 4000001  | Steel Sheet | 1,000 PC  | 1,200 PC  | $5,000   | $6,000
           |          | 15.03.2024  | 101       | +500 PC   |          | $2,500
           |          | 20.03.2024  | 701       | -300 PC   |          | $1,500
FG         | 5000001  | Frame Assy  | 100 PC    | 150 PC    | $10,000  | $15,000
           |          | 18.03.2024  | 101       | +75 PC    |          | $7,500
           |          | 25.03.2024  | 601       | -25 PC    |          | $2,500
```

## üõ†Ô∏è Technical Details

### Prerequisites
- SAP ECC 6.0 or S/4HANA
- Authorization for tables: MSLB, MSLBH, MSEG, MBEW, EKKO, EKPO
- Transaction code assignment (optional)

### Installation Steps

1. **Copy the source code**
2. **Create program in SE38/SE80**
   ```
   Program Name: ZSUBCONTRACTOR_STOCK_REPORT
   Type: Executable Program
   ```
3. **Activate the program**
4. **Create transaction code (optional)**
   ```
   Transaction: ZMM_SUBCON_STOCK
   Program: ZSUBCONTRACTOR_STOCK_REPORT
   ```

### Key Tables Used
- **MSLB/MSLBH**: Special stock at vendor (current/historical)
- **MBEW/MBEWH**: Material valuation (current/historical)
- **MSEG**: Material documents for movements
- **EKKO/EKPO**: Purchase order data for subcontracting

## üíª Usage Instructions

### Selection Screen Parameters:

1. **Material** (Optional)
   - Leave blank for all materials
   - Use standard SAP selection options

2. **Supplier** (Mandatory)
   - Select one or multiple subcontractors
   - F4 help available

3. **Period Range**
   - From Year/Period: Starting fiscal year and period
   - To Year/Period: Ending fiscal year and period
   - Default: Previous fiscal year based on current date

### Running the Report:

1. Enter selection criteria
2. Press F8 or Execute button
3. Results display in ALV grid
4. Use standard ALV functions:
   - Sort, filter, subtotal
   - Export to Excel
   - Save layout
   - Print

## üìù Business Scenarios

### Scenario 1: Month-End Reconciliation
Monitor subcontractor inventory levels and values for financial closing.

### Scenario 2: Vendor Performance Analysis
Track consumption patterns and efficiency of different subcontractors.

### Scenario 3: Audit Support
Provide detailed transaction history for internal/external audits.

### Scenario 4: Inventory Planning
Analyze stock trends to optimize material provisioning to vendors.

## ü§ñ AI-Powered Development

This report was developed using AI assistance to:
- Optimize data retrieval logic
- Implement complex fiscal period calculations
- Create intuitive ALV display formatting
- Add comprehensive error handling
- Generate detailed documentation

**Note**: While AI accelerated development, all code has been tested and validated in real SAP environments to ensure accuracy and performance.

## ‚ö° Performance Considerations

- Optimized for large data volumes (tested with 100K+ records)
- Efficient database selections using FOR ALL ENTRIES
- Period-based filtering reduces data processing
- Background execution supported for large selections

## üêõ Troubleshooting

### Common Issues:

**"No stock data found"**
- Verify vendor has special stock in selected period
- Check fiscal year/period selection
- Ensure proper authorizations

**"Missing values"**
- Check material valuation data exists
- Verify moving average price maintained
- Confirm valuation area configuration

**Performance issues**
- Reduce date range selection
- Run in background for large datasets
- Consider vendor-specific execution

## üîÑ Future Enhancements

Potential improvements identified:
- [ ] Multi-currency support
- [ ] Graphical trend analysis
- [ ] Email scheduling capability
- [ ] Integration with vendor portals
- [ ] Predictive analytics for stock levels

## üìÑ License

This report is licensed under Creative Commons BY-NC-SA 4.0
- ‚úÖ Free for personal/educational use
- ‚úÖ Modify and share improvements
- ‚ùå No commercial distribution
- ‚è∞ Attribution required

## üôè Acknowledgments

- SAP MM community for business requirements
- AI tools for accelerating development
- Beta testers for valuable feedback

---

**üí° Pro Tip**: Save your frequently used selection variants for quick execution!

**Need Help?** Create an issue in the main repository or reach out through discussions.
